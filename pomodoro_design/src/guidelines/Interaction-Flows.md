# Pomodoro Dungeon App - 關鍵互動流程設計

## 流程 1: 首次使用流程 (First-Time User Experience)

### 目標
引導新用戶了解核心功能,建立帳號,開始第一次專注

### 流程圖
```
[啟動 App] 
    ↓
[啟動畫面 3秒]
  - Logo 動畫
  - 載入檢查
    ↓
[引導頁 1/3] 專注戰鬥
  - 勇者 VS 怪物動畫
  - 核心概念介紹
    ↓ 滑動/點擊下一步
[引導頁 2/3] 獲得獎勵
  - 金幣動畫
  - 獎勵機制說明
    ↓ 滑動/點擊下一步
[引導頁 3/3] 公會競爭
  - 排行榜展示
  - 社交功能介紹
    ↓ 點擊「開始冒險」
[註冊頁面]
  ├─ 輸入名稱
  ├─ 選擇學校
  ├─ 輸入 EDU Email
  │  └─ 即時驗證 .edu 格式
  ├─ 設定密碼
  │  └─ 顯示強度指示器
  └─ 勾選同意條款
    ↓ 點擊「開始冒險」
[註冊中...]
  - 按鈕顯示 Loading
  - 發送驗證請求
    ↓ 成功
[歡迎動畫]
  - 全螢幕慶祝效果
  - "歡迎加入, [名稱]!"
    ↓ 2秒後
[主頁 - 番茄鐘]
  - 初始狀態: 25:00
  - Toast: "點擊開始按鈕開始你的第一次冒險!"
```

### 關鍵設計決策

1. **可跳過的引導**
   - 每頁右上角都有「跳過」按鈕
   - 減少強制觀看的挫折感

2. **進度指示器**
   - 底部小圓點 (○●○) 顯示當前頁
   - 讓用戶知道還有多長

3. **動畫吸引注意**
   - 每頁都有互動動畫
   - 視覺化抽象概念

4. **即時表單驗證**
   - Email 輸入時即時檢查格式
   - 密碼強度即時顯示
   - 減少表單提交後的錯誤

---

## 流程 2: 開始一個番茄鐘 (Start Focus Session)

### 目標
從主頁開始計時,完成專注,獲得獎勵

### 詳細流程

#### Step 1: 準備階段
```
[主頁 - 番茄鐘頁面]
  狀態: 未開始
  顯示: 
    - 計時器: 25:00
    - 勇者: 站立在起點
    - 怪物: 在右側等待
    - 進度條: 0%
    - 按鈕: "▶️ 開始"
```

**用戶操作**: 點擊「開始」按鈕

**系統反應**:
1. 按鈕觸覺反饋 (vibration - 可選)
2. 按鈕變為「⏸ 暫停」
3. 按鈕縮小動畫 (scale 0.95 → 1.0)
4. Toast 提示: "加油!專注 25 分鐘!"

#### Step 2: 計時進行中
```
[專注計時中]
  狀態: Active
  顯示:
    - 計時器: 24:59... 倒數中
      └─ 每秒輕微脈動效果
    - 勇者: 開始行走
      ├─ 水平移動 (左→右)
      ├─ 上下彈跳動畫
      └─ 腳下塵土效果 💨
    - 怪物: 緩慢呼吸動畫
    - 進度條: 逐漸填充 (紅橙漸變)
    - 按鈕: "⏸ 暫停"
```

**互動選項**:

**選項 A: 暫停**
```
用戶點擊「暫停」
  ↓
[暫停狀態]
  - 所有動畫停止
  - 計時器停止
  - 按鈕變為「▶️ 繼續」
  - Toast: "已暫停,休息一下"
  ↓
用戶點擊「繼續」
  - 所有動畫恢復
  - 繼續計時
```

**選項 B: 重置**
```
用戶點擊「重置」
  ↓
[確認對話框]
  "確定要重置計時器嗎?
   進度將不會被保存。"
  [取消] [確定重置]
  ↓ 點擊確定
[重置動畫]
  - 計時器數字旋轉回 25:00
  - 勇者跑回起點
  - 進度條清空
  - Toast: "已重置"
```

#### Step 3: 最後 1 分鐘 (緊張時刻)
```
[計時器 < 01:00]
  視覺變化:
    - 計時器數字: 紅色閃爍
    - 怪物: 加速呼吸
    - 勇者: 加速跑動
    - 背景: 紅色脈動光暈
  
  音效 (可選):
    - 心跳聲加速
    - 緊張背景音樂
```

#### Step 4: 完成時刻 (高潮)
```
[計時器 00:00]
  ↓
[自動觸發完成動畫序列]

1. 停止計時 (0ms)
   - isActive = false
   - 所有計時停止

2. 勝利動作 (0-500ms)
   - 勇者到達怪物位置
   - 怪物淡出消失
   - 勇者跳躍勝利姿態

3. 金幣掉落 (500-1000ms)
   - 怪物位置掉落金幣 💰
   - 金幣飛向頂部金幣數字
   - 途中旋轉閃爍

4. 數字更新 (1000-1500ms)
   - 頂部金幣數字 +10
   - 彈跳放大動畫
   - "💰 +10" 浮動提示

5. 獎勵 Modal 彈出 (1500ms)
```

#### Step 5: 獎勵顯示
```
[全螢幕 Modal - 半透明黑背景]
┌─────────────────────────────┐
│                             │
│        勝利! 🎉             │
│                             │
│         💰                  │
│    [金幣旋轉動畫]           │
│                             │
│    獲得 10 金幣              │
│                             │
│    ⚡ +25 XP                │
│    🔥 連勝 +1                │
│    📊 今日第 3 次完成        │
│                             │
│  [繼續專注] [開始休息]       │
│                             │
└─────────────────────────────┘
```

**用戶選擇**:

**選項 A: 繼續專注**
```
點擊「繼續專注」
  ↓
[Modal 關閉]
  ↓
[重置計時器]
  - 計時器回到 25:00
  - 勇者回到起點
  - 新怪物出現
  - 狀態回到「未開始」
```

**選項 B: 開始休息**
```
點擊「開始休息」
  ↓
[切換到休息模式]
  - 模式標籤切換到「休息時間」
  - 計時器變為 05:00
  - 背景漸變: 紅橙 → 綠色
  - 怪物消失
  - 顯示 🧘 冥想圖示
  - Toast: "休息 5 分鐘,恢復體力"
  ↓
[自動開始休息計時]
```

---

## 流程 3: 兌換獎勵流程 (Redeem Reward)

### 目標
瀏覽商店,選擇獎勵,完成兌換

### 詳細流程

#### Step 1: 進入商店
```
[點擊底部導航「商店」]
  ↓
[頁面切換動畫 300ms]
  - 淡出當前頁
  - 淡入商店頁
  ↓
[商店頁面載入]
  狀態: 載入中
  顯示: Skeleton Screen
    - 分類標籤: 灰色方塊
    - 獎勵卡片: 灰色卡片動畫
  ↓ 500ms 後
  狀態: 載入完成
  顯示: 實際內容
    - 分類標籤: [全部] [實體] [數位] [體驗]
    - 獎勵卡片: 淡入動畫 (stagger 100ms)
```

#### Step 2: 瀏覽獎勵
```
[瀏覽模式]
  用戶可進行:
    1. 上下滾動查看獎勵
       - 無限滾動
       - 到底部時顯示「已經到底囉 🏺」
    
    2. 切換分類
       點擊分類標籤
       ↓
       [篩選動畫]
       - 當前卡片淡出 (200ms)
       - 新卡片淡入 (200ms, stagger 50ms)
       - 底部指示器滑動
    
    3. 查看卡片詳情
       每張卡片顯示:
       ├─ 圖標 (64px emoji)
       ├─ 名稱
       ├─ 描述
       ├─ 價格 (💰 數字)
       │  └─ 顏色: 可負擔=金色, 不足=紅色
       ├─ 庫存 (若有限)
       └─ 購買按鈕狀態:
           ├─ 可購買: 紫粉漸變 "購買"
           ├─ 已購買: 綠色 "✓ 已購買"
           ├─ 金幣不足: 灰色禁用 "金幣不足"
           └─ 已售罄: 灰色 "已售罄"
```

#### Step 3: 選擇獎勵
```
[用戶點擊「購買」按鈕]
  ↓
[即時檢查]
  IF 金幣 >= 價格:
    ↓ 繼續
  ELSE:
    ↓
    [Toast 錯誤通知]
    "💰 金幣不足!還需要 XX 金幣"
    - 持續 3 秒
    - 紅色背景
    - 震動效果
    ↓
    結束流程
```

#### Step 4: 確認兌換
```
[彈出確認 Modal]
┌───────────────────────────────┐
│  確認兌換?                    │
│                               │
│       ☕                       │
│   [獎勵圖標放大顯示]          │
│                               │
│  星巴克咖啡券                 │
│  一杯中杯飲料兌換券           │
│                               │
│  花費: 💰 50                  │
│  餘額: 💰 100 → 50            │
│  ─────────────────            │
│                               │
│  ⚠️ 兌換後將發送到你的 Email  │
│    student@ntu.edu.tw         │
│                               │
│  [取消]      [確認兌換]       │
│  (外框灰色)   (紫粉漸變)      │
└───────────────────────────────┘
```

**互動**:
- **點擊外部**: Modal 關閉
- **點擊取消**: Modal 關閉, 無操作
- **點擊確認**: 進入下一步

#### Step 5: 處理兌換
```
[點擊「確認兌換」]
  ↓
[按鈕狀態變化]
  - 禁用其他按鈕
  - 確認按鈕顯示 Loading
  - 文字變為「兌換中...」
  - 按鈕內 Spinner 旋轉
  ↓
[模擬 API 請求 1-2秒]
  - 檢查餘額
  - 扣除金幣
  - 發送兌換碼到 Email
  - 記錄兌換歷史
  ↓
[成功響應]
```

#### Step 6: 成功反饋
```
[Modal 關閉動畫]
  - 縮小淡出 (300ms)
  ↓
[頂部金幣數字更新]
  1. 數字變紅色
  2. -50 浮動向下消失
  3. 數字縮小
  4. 150 → 100 數字滾動
  5. 彈跳回正常大小
  ↓
[Toast 成功通知]
  "🎉 兌換成功!"
  "兌換碼已發送到 student@ntu.edu.tw"
  - 綠色背景
  - 持續 5 秒
  - 可手動關閉
  ↓
[卡片狀態更新]
  - 購買按鈕變為綠色
  - 文字變為「✓ 已購買」
  - 卡片右上角綠色勾號徽章
  - 禁用再次購買
```

---

## 流程 4: 查看排行榜 (View Rankings)

### 目標
查看公會/個人排名,激發競爭動力

### 詳細流程

#### Step 1: 進入排行榜
```
[點擊底部導航「排名」]
  ↓
[頁面切換 300ms]
  ↓
[排行榜頁面]
  初始狀態: 公會排名
  顯示:
    - 頂部橫幅:
      ├─ 你的公會: 午夜學者公會
      ├─ 當前排名: #3
      └─ 背景: 公會 Banner 圖
    - 標籤切換: [公會排名●] [個人排名○]
    - 時間範圍: [本週 ▼]
```

#### Step 2: 查看排名列表
```
[公會排名列表]
  
  卡片 1 (金色背景 + 光暈):
  ┌────────────────────────────┐
  │ 👑 1  深夜學者公會         │
  │      台灣大學              │
  │      12,500 分鐘  45人     │
  │      ↑ 2 (綠色上升箭頭)    │
  └────────────────────────────┘
  
  卡片 2 (銀色背景):
  ┌────────────────────────────┐
  │ 🥈 2  黎明戰士團           │
  │      清華大學              │
  │      11,800 分鐘  38人     │
  │      ↓ 1 (紅色下降箭頭)    │
  └────────────────────────────┘
  
  卡片 3 (紫色邊框高亮 - 用戶公會):
  ┌────────────────────────────┐
  │ 🥉 3  午夜學者公會  [你]   │
  │      台灣大學              │
  │      10,900 分鐘  42人     │
  │      ↑ 1 (綠色上升箭頭)    │
  └────────────────────────────┘
  
  ...其他排名
```

**視覺反饋**:
- 用戶公會卡片: 紫色發光邊框
- 自動滾動到用戶公會位置
- 入場動畫: 從上到下依序淡入

#### Step 3: 切換排名類型
```
[點擊「個人排名」標籤]
  ↓
[切換動畫]
  1. 底部指示器滑動 (300ms)
  2. 當前列表淡出 (200ms)
  3. 新列表淡入 (200ms, stagger 50ms)
  ↓
[個人排名列表]
  顯示個人玩家排名
  自動滾動到當前用戶位置
  高亮當前用戶卡片
```

#### Step 4: 切換時間範圍
```
[點擊「本週 ▼」下拉選單]
  ↓
[下拉選單展開]
  ├─ ○ 今日
  ├─ ● 本週 (選中)
  ├─ ○ 本月
  └─ ○ 總排行
  ↓
[選擇「總排行」]
  ↓
[資料重新載入]
  1. 顯示 Skeleton
  2. 模擬載入 500ms
  3. 新數據淡入
  4. 自動滾動到用戶位置
```

#### Step 5: 查看賽季資訊
```
[底部固定區域]
┌─────────────────────────────┐
│  賽季結束倒數: 7 天 14 小時  │
│  🎁 前三名將獲得特殊獎勵    │
│    ├─ 第1名: 200 金幣       │
│    ├─ 第2名: 100 金幣       │
│    └─ 第3名: 50 金幣        │
└─────────────────────────────┘
```

**互動**:
- 倒數計時每秒更新
- 點擊可展開查看詳細獎勵

---

## 通用互動模式

### 頁面切換動畫
```
所有頁面切換使用一致的動畫:
  1. 當前頁淡出 (200ms)
  2. 新頁面淡入 (200ms)
  3. 底部導航圖標縮放 (150ms)
     - 選中: scale(1.05)
     - 未選中: scale(1.0)
```

### 錯誤處理統一模式
```
任何錯誤發生時:
  1. Toast 通知
     - 紅色背景
     - 錯誤圖標 ⚠️
     - 錯誤訊息
     - 持續 4 秒
  
  2. 震動反饋 (手機)
     - 短震 100ms
  
  3. 視覺反饋
     - 相關元素紅色閃爍
     - 搖晃動畫 (左右 5px, 3次)
```

### 載入狀態統一模式
```
所有需要等待的操作:
  1. 按鈕內 Loading
     - 禁用按鈕
     - 顯示 Spinner
     - 文字變為「XX中...」
  
  2. 全頁 Loading
     - Skeleton Screen
     - 模擬真實內容結構
     - 灰色脈動動畫
  
  3. 局部 Loading
     - 區域覆蓋半透明層
     - 中央 Spinner
```

---

## 微互動細節

### 按鈕點擊
```
所有按鈕點擊統一反饋:
  1. Hover (桌面)
     - scale(1.02)
     - brightness(110%)
     - 200ms 過渡
  
  2. Active (按下)
     - scale(0.98)
     - 100ms 過渡
  
  3. 點擊後
     - 漣漪效果從點擊位置擴散
     - 300ms 淡出
```

### 數字變化動畫
```
金幣、XP、統計數字變化時:
  1. 舊數字淡出向上飄
  2. 新數字從下方淡入
  3. 整體彈跳放大 (scale 1 → 1.2 → 1)
  4. 持續 500ms
```

### 卡片互動
```
所有卡片 Hover 時:
  - translateY(-4px)
  - 陰影加深
  - 300ms 過渡

點擊時:
  - 輕微縮小 scale(0.99)
  - 150ms
```

---

這些互動流程確保了整個 App 的使用體驗流暢、一致且具有愉悅感,每個操作都有明確的視覺反饋。
